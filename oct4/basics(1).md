# –°–µ–º–∞—Ñ–æ—Ä—ã: –ø–æ–¥—Ä–æ–±–Ω–æ–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ
# –î–∏–∞–≥—Ä–∞–º–º–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Ä–∞–±–æ—Ç—ã —Å–µ–º–∞—Ñ–æ—Ä–∞

```mermaid
sequenceDiagram
    participant T1 as –ü–æ—Ç–æ–∫ 1
    participant T2 as –ü–æ—Ç–æ–∫ 2
    participant T3 as –ü–æ—Ç–æ–∫ 3
    participant T4 as –ü–æ—Ç–æ–∫ 4
    participant Sem as –°–µ–º–∞—Ñ–æ—Ä(3)

    Note over Sem: –ù–∞—á–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ: 3

    T1->>Sem: acquire()
    Note over Sem: –ó–Ω–∞—á–µ–Ω–∏–µ: 3 ‚Üí 2
    Sem-->>T1: –£–°–ü–ï–•
    T1->>T1: –†–∞–±–æ—Ç–∞ –≤ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–π —Å–µ–∫—Ü–∏–∏

    T2->>Sem: acquire()
    Note over Sem: –ó–Ω–∞—á–µ–Ω–∏–µ: 2 ‚Üí 1
    Sem-->>T2: –£–°–ü–ï–•
    T2->>T2: –†–∞–±–æ—Ç–∞ –≤ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–π —Å–µ–∫—Ü–∏–∏

    T3->>Sem: acquire()
    Note over Sem: –ó–Ω–∞—á–µ–Ω–∏–µ: 1 ‚Üí 0
    Sem-->>T3: –£–°–ü–ï–•
    T3->>T3: –†–∞–±–æ—Ç–∞ –≤ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–π —Å–µ–∫—Ü–∏–∏

    T4->>Sem: acquire()
    Note over Sem: –ó–Ω–∞—á–µ–Ω–∏–µ: 0<br>–ü–æ—Ç–æ–∫ –ë–õ–û–ö–ò–†–û–í–ê–ù
    Sem-->>T4: –û–ñ–ò–î–ê–ù–ò–ï...

    T1->>Sem: release()
    Note over Sem: –ó–Ω–∞—á–µ–Ω–∏–µ: 0 ‚Üí 1<br>–†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –æ–∂–∏–¥–∞—é—â–∏–π –ø–æ—Ç–æ–∫
    Sem-->>T4: –£–°–ü–ï–• (—Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω)
    Note over Sem: –ó–Ω–∞—á–µ–Ω–∏–µ: 1 ‚Üí 0
    T4->>T4: –†–∞–±–æ—Ç–∞ –≤ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–π —Å–µ–∫—Ü–∏–∏

    T2->>Sem: release()
    Note over Sem: –ó–Ω–∞—á–µ–Ω–∏–µ: 0 ‚Üí 1
    T3->>Sem: release()
    Note over Sem: –ó–Ω–∞—á–µ–Ω–∏–µ: 1 ‚Üí 2
    T4->>Sem: release()
    Note over Sem: –ó–Ω–∞—á–µ–Ω–∏–µ: 2 ‚Üí 3
```

## –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∞—è –¥–∏–∞–≥—Ä–∞–º–º–∞ - –±–æ–ª–µ–µ –¥–µ—Ç–∞–ª—å–Ω–∞—è:

```mermaid
sequenceDiagram
    participant T as –ü–æ—Ç–æ–∫–∏
    participant S as –°–µ–º–∞—Ñ–æ—Ä
    participant CS as –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è<br>—Å–µ–∫—Ü–∏—è

    Note over S: –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è: count = 3

    loop 10 –ø–æ—Ç–æ–∫–æ–≤
        T->>S: acquire()
        Note right of S: count = count - 1
        alt count >= 0
            S-->>T: –£—Å–ø–µ—Ö
            T->>CS: –í—Ö–æ–¥ –≤ –∫—Ä–∏—Ç–∏—á–µ—Å–∫—É—é —Å–µ–∫—Ü–∏—é
            Note over CS: –ú–∞–∫—Å–∏–º—É–º 3 –ø–æ—Ç–æ–∫–∞<br>–æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
            T->>CS: –†–∞–±–æ—Ç–∞ —Å –æ–±—â–∏–º —Ä–µ—Å—É—Ä—Å–æ–º
            T->>S: release()
            Note right of S: count = count + 1
        else count < 0
            S-->>T: –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞
            Note over T: –ü–æ—Ç–æ–∫ –∂–¥–µ—Ç –≤ –æ—á–µ—Ä–µ–¥–∏
            S->>T: –ü—Ä–æ–±—É–∂–¥–µ–Ω–∏–µ (–ø—Ä–∏ release)
            S-->>T: –£—Å–ø–µ—Ö
            T->>CS: –í—Ö–æ–¥ –≤ –∫—Ä–∏—Ç–∏—á–µ—Å–∫—É—é —Å–µ–∫—Ü–∏—é
            T->>CS: –†–∞–±–æ—Ç–∞ —Å –æ–±—â–∏–º —Ä–µ—Å—É—Ä—Å–æ–º
            T->>S: release()
            Note right of S: count = count + 1
        end
    end
```

## –î–∏–∞–≥—Ä–∞–º–º–∞ –¥–ª—è –±–∏–Ω–∞—Ä–Ω–æ–≥–æ —Å–µ–º–∞—Ñ–æ—Ä–∞ (–º—å—é—Ç–µ–∫—Å):

```mermaid
sequenceDiagram
    participant T1 as –ü–æ—Ç–æ–∫ 1
    participant T2 as –ü–æ—Ç–æ–∫ 2
    participant Mutex as –ú—å—é—Ç–µ–∫—Å(1)

    Note over Mutex: –ù–∞—á–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ: 1 (—Å–≤–æ–±–æ–¥–µ–Ω)

    T1->>Mutex: acquire()
    Note over Mutex: –ó–Ω–∞—á–µ–Ω–∏–µ: 1 ‚Üí 0 (–∑–∞–Ω—è—Ç)
    Mutex-->>T1: –£–°–ü–ï–•
    T1->>T1: –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è —Å–µ–∫—Ü–∏—è

    T2->>Mutex: acquire()
    Note over Mutex: –ó–Ω–∞—á–µ–Ω–∏–µ: 0 (—É–∂–µ –∑–∞–Ω—è—Ç)
    Mutex-->>T2: –ë–õ–û–ö–ò–†–û–í–ö–ê

    T1->>Mutex: release()
    Note over Mutex: –ó–Ω–∞—á–µ–Ω–∏–µ: 0 ‚Üí 1 (—Å–≤–æ–±–æ–¥–µ–Ω)<br>–ü—Ä–æ–±—É–¥–∏—Ç—å –æ–∂–∏–¥–∞—é—â–∏–π
    Mutex-->>T2: –£–°–ü–ï–• (—Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω)
    Note over Mutex: –ó–Ω–∞—á–µ–Ω–∏–µ: 1 ‚Üí 0 (–∑–∞–Ω—è—Ç)
    
    T2->>T2: –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è —Å–µ–∫—Ü–∏—è
    T2->>Mutex: release()
    Note over Mutex: –ó–Ω–∞—á–µ–Ω–∏–µ: 0 ‚Üí 1 (—Å–≤–æ–±–æ–¥–µ–Ω)
```

## –î–∏–∞–≥—Ä–∞–º–º–∞ —Å —Ç–∞–π–º–∞—É—Ç–æ–º:

```mermaid
sequenceDiagram
    participant T as –ü–æ—Ç–æ–∫
    participant S as –°–µ–º–∞—Ñ–æ—Ä(2)
    participant Timer as –¢–∞–π–º–µ—Ä

    Note over S: –ù–∞—á–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ: 2

    T->>S: acquire(timeout=3)
    
    alt –ï—Å—Ç—å —Å–≤–æ–±–æ–¥–Ω—ã–µ —Å–ª–æ—Ç—ã
        S-->>T: –ù–µ–º–µ–¥–ª–µ–Ω–Ω—ã–π —É—Å–ø–µ—Ö
    else –ù–µ—Ç —Å–≤–æ–±–æ–¥–Ω—ã—Ö —Å–ª–æ—Ç–æ–≤
        S-->>T: –û–∂–∏–¥–∞–Ω–∏–µ...
        T->>Timer: –ó–∞–ø—É—Å–∫ —Ç–∞–π–º–∞—É—Ç–∞ (3 —Å–µ–∫)
        
        alt –û—Å–≤–æ–±–æ–¥–∏–ª—Å—è –∑–∞ 3 —Å–µ–∫
            S-->>T: –£—Å–ø–µ—Ö (–ø–æ—Å–ª–µ –æ–∂–∏–¥–∞–Ω–∏—è)
            Timer->>T: –û—Ç–º–µ–Ω–∞ —Ç–∞–π–º–µ—Ä–∞
        else –¢–∞–π–º–∞—É—Ç –∏—Å—Ç–µ–∫
            Timer->>T: –í—Ä–µ–º—è –≤—ã—à–ª–æ!
            T->>S: –û—Ç–º–µ–Ω–∞ –æ–∂–∏–¥–∞–Ω–∏—è
            S-->>T: –¢–ê–ô–ú–ê–£–¢
        end
    end
```

## –û–±—ä—è—Å–Ω–µ–Ω–∏–µ –∫–ª—é—á–µ–≤—ã—Ö –º–æ–º–µ–Ω—Ç–æ–≤:

### 1. **–°–æ—Å—Ç–æ—è–Ω–∏—è —Å–µ–º–∞—Ñ–æ—Ä–∞**:
- **–ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ**: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Å–ª–æ—Ç–æ–≤
- **–ù–æ–ª—å**: –í—Å–µ —Å–ª–æ—Ç—ã –∑–∞–Ω—è—Ç—ã, –Ω–æ –Ω–µ—Ç –æ–∂–∏–¥–∞—é—â–∏—Ö
- **–û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ**: –ê–±—Å–æ–ª—é—Ç–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–∂–∏–¥–∞—é—â–∏—Ö –ø–æ—Ç–æ–∫–æ–≤

### 2. **–û–ø–µ—Ä–∞—Ü–∏–∏**:
- **acquire()**: –£–º–µ–Ω—å—à–∞–µ—Ç —Å—á–µ—Ç—á–∏–∫. –ï—Å–ª–∏ < 0 - –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è.
- **release()**: –£–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç —Å—á–µ—Ç—á–∏–∫. –ï—Å–ª–∏ –µ—Å—Ç—å –æ–∂–∏–¥–∞—é—â–∏–µ - –±—É–¥–∏—Ç –æ–¥–Ω–æ–≥–æ.

### 3. **–ü–æ–≤–µ–¥–µ–Ω–∏–µ**:
- **–°–ø—Ä–∞–≤–µ–¥–ª–∏–≤–æ—Å—Ç—å**: –û–±—ã—á–Ω–æ FIFO (–ø–µ—Ä–≤—ã–π –ø—Ä–∏—à–µ–ª - –ø–µ—Ä–≤—ã–π –æ–±—Å–ª—É–∂–µ–Ω)
- **–ê—Ç–æ–º–∞—Ä–Ω–æ—Å—Ç—å**: –û–ø–µ—Ä–∞—Ü–∏–∏ –Ω–µ–¥–µ–ª–∏–º—ã (–Ω–µ –º–æ–≥—É—Ç –±—ã—Ç—å –ø—Ä–µ—Ä–≤–∞–Ω—ã)
- **–ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞**: –ü–æ—Ç–æ–∫–∏ —Å–ø—è—Ç, –∞ –Ω–µ busy-wait (—ç–∫–æ–Ω–æ–º—è—Ç CPU)

–≠—Ç–∞ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ–º–æ–≥–∞–µ—Ç –ø–æ–Ω—è—Ç—å, –∫–∞–∫ —Å–µ–º–∞—Ñ–æ—Ä—ã –∫–æ–æ—Ä–¥–∏–Ω–∏—Ä—É—é—Ç –¥–æ—Å—Ç—É–ø –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –ø–æ—Ç–æ–∫–æ–≤ –∫ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–º —Ä–µ—Å—É—Ä—Å–∞–º! üéØ

## –ß—Ç–æ —Ç–∞–∫–æ–µ —Å–µ–º–∞—Ñ–æ—Ä?

**–°–µ–º–∞—Ñ–æ—Ä** - —ç—Ç–æ –º–µ—Ö–∞–Ω–∏–∑–º —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π –≤ –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ–º –∏ –º–Ω–æ–≥–æ–ø—Ä–æ—Ü–µ—Å—Å–Ω–æ–º –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–∏ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–æ–º –∫ –æ–±—â–∏–º —Ä–µ—Å—É—Ä—Å–∞–º.

### –ü—Ä–æ—Å—Ç–∞—è –∞–Ω–∞–ª–æ–≥–∏—è
–ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ —Å–µ–±–µ **—Å—Ç–æ–ª–æ–≤—É—é —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –º–µ—Å—Ç**:
- **–°—Ç–æ–ª–æ–≤–∞—è** - –æ–±—â–∏–π —Ä–µ—Å—É—Ä—Å
- **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–µ—Å—Ç** - –∑–Ω–∞—á–µ–Ω–∏–µ —Å–µ–º–∞—Ñ–æ—Ä–∞
- **–ü–æ—Å–µ—Ç–∏—Ç–µ–ª–∏** - –ø–æ—Ç–æ–∫–∏/–ø—Ä–æ—Ü–µ—Å—Å—ã
- **–ó–∞–Ω—è—Ç—å –º–µ—Å—Ç–æ** - –∑–∞—Ö–≤–∞—Ç–∏—Ç—å —Å–µ–º–∞—Ñ–æ—Ä (`acquire`)
- **–û—Å–≤–æ–±–æ–¥–∏—Ç—å –º–µ—Å—Ç–æ** - –æ—Å–≤–æ–±–æ–¥–∏—Ç—å —Å–µ–º–∞—Ñ–æ—Ä (`release`)

## –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏

### –°—á–µ—Ç—á–∏–∫ —Å–µ–º–∞—Ñ–æ—Ä–∞
–°–µ–º–∞—Ñ–æ—Ä —Å–æ–¥–µ—Ä–∂–∏—Ç –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π —Å—á–µ—Ç—á–∏–∫, –∫–æ—Ç–æ—Ä—ã–π:
- –£–º–µ–Ω—å—à–∞–µ—Ç—Å—è –ø—Ä–∏ –∑–∞—Ö–≤–∞—Ç–µ (`acquire`)
- –£–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–∏ (`release`)
- –ù–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–º (–¥–ª—è –æ–±—ã—á–Ω—ã—Ö —Å–µ–º–∞—Ñ–æ—Ä–æ–≤)

### –¢–∏–ø—ã —Å–µ–º–∞—Ñ–æ—Ä–æ–≤

#### 1. –ë–∏–Ω–∞—Ä–Ω—ã–π —Å–µ–º–∞—Ñ–æ—Ä (Mutex)
- –ó–Ω–∞—á–µ–Ω–∏–µ: 0 –∏–ª–∏ 1
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –≤–∑–∞–∏–º–æ–∏—Å–∫–ª—é—á–µ–Ω–∏–π (mutual exclusion)
- –¢–æ–ª—å–∫–æ –æ–¥–∏–Ω –ø–æ—Ç–æ–∫ –º–æ–∂–µ—Ç –∑–∞—Ö–≤–∞—Ç–∏—Ç—å —Ä–µ—Å—É—Ä—Å

#### 2. –°—á–µ—Ç–Ω—ã–π —Å–µ–º–∞—Ñ–æ—Ä
- –ó–Ω–∞—á–µ–Ω–∏–µ: –ª—é–±–æ–µ –Ω–µ–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–µ —Ü–µ–ª–æ–µ —á–∏—Å–ª–æ
- –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Ç–æ–∫–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ —Ä–µ—Å—É—Ä—Å—É

## –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å–µ–º–∞—Ñ–æ—Ä–æ–≤ –≤ Python

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `threading.Semaphore`

```python
import threading
import time
import random

# –°–æ–∑–¥–∞–Ω–∏–µ —Å–µ–º–∞—Ñ–æ—Ä–∞ —Å –Ω–∞—á–∞–ª—å–Ω—ã–º –∑–Ω–∞—á–µ–Ω–∏–µ–º 3
semaphore = threading.Semaphore(3)

def worker(worker_id):
    """–§—É–Ω–∫—Ü–∏—è —Ä–∞–±–æ—á–µ–≥–æ –ø–æ—Ç–æ–∫–∞"""
    print(f"–†–∞–±–æ—Ç–Ω–∏–∫ {worker_id} –∂–¥–µ—Ç –¥–æ—Å—Ç—É–ø–∞...")
    
    # –ó–∞—Ö–≤–∞—Ç —Å–µ–º–∞—Ñ–æ—Ä–∞
    semaphore.acquire()
    
    try:
        print(f"–†–∞–±–æ—Ç–Ω–∏–∫ {worker_id} –ø–æ–ª—É—á–∏–ª –¥–æ—Å—Ç—É–ø!")
        # –ò–º–∏—Ç–∞—Ü–∏—è —Ä–∞–±–æ—Ç—ã
        time.sleep(random.uniform(1, 3))
        print(f"–†–∞–±–æ—Ç–Ω–∏–∫ {worker_id} –∑–∞–≤–µ—Ä—à–∏–ª —Ä–∞–±–æ—Ç—É.")
    finally:
        # –û—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ —Å–µ–º–∞—Ñ–æ—Ä–∞
        semaphore.release()
        print(f"–†–∞–±–æ—Ç–Ω–∏–∫ {worker_id} –æ—Å–≤–æ–±–æ–¥–∏–ª –¥–æ—Å—Ç—É–ø.")

# –°–æ–∑–¥–∞–Ω–∏–µ –∏ –∑–∞–ø—É—Å–∫ –ø–æ—Ç–æ–∫–æ–≤
threads = []
for i in range(10):
    t = threading.Thread(target=worker, args=(i,))
    threads.append(t)
    t.start()

# –û–∂–∏–¥–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –≤—Å–µ—Ö –ø–æ—Ç–æ–∫–æ–≤
for t in threads:
    t.join()

print("–í—Å–µ —Ä–∞–±–æ—Ç—ã –∑–∞–≤–µ—Ä—à–µ–Ω—ã!")
```

## –î–µ—Ç–∞–ª—å–Ω—ã–π —Ä–∞–∑–±–æ—Ä —Ä–∞–±–æ—Ç—ã –∫–æ–¥–∞

### –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è:
```python
semaphore = threading.Semaphore(3)
```
–°–æ–∑–¥–∞–µ—Ç—Å—è —Å–µ–º–∞—Ñ–æ—Ä —Å–æ –∑–Ω–∞—á–µ–Ω–∏–µ–º 3 - —ç—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –º–æ–≥—É—Ç —Ä–∞–±–æ—Ç–∞—Ç—å **3 –ø–æ—Ç–æ–∫–∞**.

### –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–∞–±–æ—Ç—ã:

```
–í—Ä–µ–º—è ‚îÇ –†–∞–±–æ—Ç–∞—é—â–∏–µ –ø–æ—Ç–æ–∫–∏ ‚îÇ –û—á–µ—Ä–µ–¥—å
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
 t=0  ‚îÇ 0, 1, 2           ‚îÇ 3,4,5,6,7,8,9
 t=1  ‚îÇ 0, 1, 3           ‚îÇ 4,5,6,7,8,9,2
 t=2  ‚îÇ 1, 3, 4           ‚îÇ 5,6,7,8,9,2,0
```

### –ü–æ—à–∞–≥–æ–≤–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ:

**–®–∞–≥ 1: –ó–∞–ø—É—Å–∫ –ø–µ—Ä–≤—ã—Ö 3 –ø–æ—Ç–æ–∫–æ–≤**
```python
# –û–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è –ø–æ—Ç–æ–∫–∏ 0, 1, 2
# –í—Å–µ –æ–Ω–∏ —É—Å–ø–µ–≤–∞—é—Ç –∑–∞—Ö–≤–∞—Ç–∏—Ç—å —Å–µ–º–∞—Ñ–æ—Ä –¥–æ —Ç–æ–≥–æ, –∫–∞–∫ –µ–≥–æ –∑–Ω–∞—á–µ–Ω–∏–µ —Å—Ç–∞–Ω–µ—Ç 0

–°–æ—Å—Ç–æ—è–Ω–∏–µ —Å–µ–º–∞—Ñ–æ—Ä–∞: 3 ‚Üí 2 ‚Üí 1 ‚Üí 0
```

**–®–∞–≥ 2: –ü–æ—Ç–æ–∫–∏ 3-9 –∂–¥—É—Ç –≤ –æ—á–µ—Ä–µ–¥–∏**
```python
# –ü–æ—Ç–æ–∫–∏ 3, 4, 5, 6, 7, 8, 9 –ø—ã—Ç–∞—é—Ç—Å—è –∑–∞—Ö–≤–∞—Ç–∏—Ç—å —Å–µ–º–∞—Ñ–æ—Ä,
# –Ω–æ –æ–Ω —É–∂–µ –∏–º–µ–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ 0, –ø–æ—ç—Ç–æ–º—É –æ–Ω–∏ –±–ª–æ–∫–∏—Ä—É—é—Ç—Å—è
```

**–®–∞–≥ 3: –û—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ –∏ –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞**
```python
# –ö–æ–≥–¥–∞ –æ–¥–∏–Ω –∏–∑ —Ä–∞–±–æ—Ç–∞—é—â–∏—Ö –ø–æ—Ç–æ–∫–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–æ—Ç–æ–∫ 0) 
# –≤—ã–∑—ã–≤–∞–µ—Ç semaphore.release(), –∑–Ω–∞—á–µ–Ω–∏–µ —Å–µ–º–∞—Ñ–æ—Ä–∞: 0 ‚Üí 1

# –û–¥–∏–Ω –∏–∑ –æ–∂–∏–¥–∞—é—â–∏—Ö –ø–æ—Ç–æ–∫–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–æ—Ç–æ–∫ 3) 
# —Ä–∞–∑–±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è –∏ –∑–∞—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç —Å–µ–º–∞—Ñ–æ—Ä: 1 ‚Üí 0
```

## –ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–æ–¥ —Å –ø–æ–¥—Ä–æ–±–Ω—ã–º –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º

–î–∞–≤–∞–π—Ç–µ —É–ª—É—á—à–∏–º –ø—Ä–∏–º–µ—Ä, —á—Ç–æ–±—ã –ª—É—á—à–µ –≤–∏–¥–µ—Ç—å, —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:

```python
import threading
import time
import random

# –°–æ–∑–¥–∞–Ω–∏–µ —Å–µ–º–∞—Ñ–æ—Ä–∞ —Å –Ω–∞—á–∞–ª—å–Ω—ã–º –∑–Ω–∞—á–µ–Ω–∏–µ–º 3
semaphore = threading.Semaphore(3)

def worker(worker_id):
    """–§—É–Ω–∫—Ü–∏—è —Ä–∞–±–æ—á–µ–≥–æ –ø–æ—Ç–æ–∫–∞"""
    print(f"[{time.strftime('%H:%M:%S')}] –†–∞–±–æ—Ç–Ω–∏–∫ {worker_id} –∂–¥–µ—Ç –¥–æ—Å—Ç—É–ø–∞...")
    
    # –ó–∞—Ö–≤–∞—Ç —Å–µ–º–∞—Ñ–æ—Ä–∞
    semaphore.acquire()
    
    try:
        print(f"[{time.strftime('%H:%M:%S')}] üü¢ –†–∞–±–æ—Ç–Ω–∏–∫ {worker_id} –ø–æ–ª—É—á–∏–ª –¥–æ—Å—Ç—É–ø! "
              f"(—Å–µ–π—á–∞—Å —Ä–∞–±–æ—Ç–∞—é—Ç: {get_active_workers()})")
        
        # –ò–º–∏—Ç–∞—Ü–∏—è —Ä–∞–±–æ—Ç—ã
        work_time = random.uniform(1, 3)
        time.sleep(work_time)
        
        print(f"[{time.strftime('%H:%M:%S')}] ‚úÖ –†–∞–±–æ—Ç–Ω–∏–∫ {worker_id} –∑–∞–≤–µ—Ä—à–∏–ª —Ä–∞–±–æ—Ç—É "
              f"(—Ä–∞–±–æ—Ç–∞–ª {work_time:.1f} —Å–µ–∫)")
    finally:
        # –û—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ —Å–µ–º–∞—Ñ–æ—Ä–∞
        semaphore.release()
        print(f"[{time.strftime('%H:%M:%S')}] üî¥ –†–∞–±–æ—Ç–Ω–∏–∫ {worker_id} –æ—Å–≤–æ–±–æ–¥–∏–ª –¥–æ—Å—Ç—É–ø.")

# –°–ø–∏—Å–æ–∫ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –∞–∫—Ç–∏–≤–Ω—ã—Ö —Ä–∞–±–æ—Ç–Ω–∏–∫–æ–≤
active_workers = []
active_workers_lock = threading.Lock()

def get_active_workers():
    with active_workers_lock:
        return active_workers.copy()

def worker_enhanced(worker_id):
    """–£–ª—É—á—à–µ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è —Ä–∞–±–æ—á–µ–≥–æ –ø–æ—Ç–æ–∫–∞ —Å –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ–º"""
    print(f"[{time.strftime('%H:%M:%S')}] –†–∞–±–æ—Ç–Ω–∏–∫ {worker_id} –∂–¥–µ—Ç –¥–æ—Å—Ç—É–ø–∞...")
    
    # –ó–∞—Ö–≤–∞—Ç —Å–µ–º–∞—Ñ–æ—Ä–∞
    semaphore.acquire()
    
    # –î–æ–±–∞–≤–ª—è–µ–º –≤ —Å–ø–∏—Å–æ–∫ –∞–∫—Ç–∏–≤–Ω—ã—Ö —Ä–∞–±–æ—Ç–Ω–∏–∫–æ–≤
    with active_workers_lock:
        active_workers.append(worker_id)
    
    try:
        print(f"[{time.strftime('%H:%M:%S')}] üü¢ –†–∞–±–æ—Ç–Ω–∏–∫ {worker_id} –ø–æ–ª—É—á–∏–ª –¥–æ—Å—Ç—É–ø! "
              f"(–∞–∫—Ç–∏–≤–Ω—ã–µ: {sorted(active_workers)})")
        
        # –ò–º–∏—Ç–∞—Ü–∏—è —Ä–∞–±–æ—Ç—ã
        work_time = random.uniform(1, 3)
        time.sleep(work_time)
        
        print(f"[{time.strftime('%H:%M:%S')}] ‚úÖ –†–∞–±–æ—Ç–Ω–∏–∫ {worker_id} –∑–∞–≤–µ—Ä—à–∏–ª —Ä–∞–±–æ—Ç—É "
              f"(—Ä–∞–±–æ—Ç–∞–ª {work_time:.1f} —Å–µ–∫)")
    finally:
        # –£–±–∏—Ä–∞–µ–º –∏–∑ —Å–ø–∏—Å–∫–∞ –∞–∫—Ç–∏–≤–Ω—ã—Ö —Ä–∞–±–æ—Ç–Ω–∏–∫–æ–≤
        with active_workers_lock:
            active_workers.remove(worker_id)
        
        # –û—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ —Å–µ–º–∞—Ñ–æ—Ä–∞
        semaphore.release()
        print(f"[{time.strftime('%H:%M:%S')}] üî¥ –†–∞–±–æ—Ç–Ω–∏–∫ {worker_id} –æ—Å–≤–æ–±–æ–¥–∏–ª –¥–æ—Å—Ç—É–ø. "
              f"(–æ—Å—Ç–∞–ª–∏—Å—å: {sorted(active_workers)})")

print("üöÄ –ó–∞–ø—É—Å–∫–∞–µ–º 10 —Ä–∞–±–æ—Ç–Ω–∏–∫–æ–≤ —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ–º –≤ 3 –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –¥–æ—Å—Ç—É–ø–∞\n")

# –°–æ–∑–¥–∞–Ω–∏–µ –∏ –∑–∞–ø—É—Å–∫ –ø–æ—Ç–æ–∫–æ–≤
threads = []
for i in range(10):
    t = threading.Thread(target=worker_enhanced, args=(i,))
    threads.append(t)
    t.start()
    time.sleep(0.1)  # –ù–µ–±–æ–ª—å—à–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É –∑–∞–ø—É—Å–∫–∞–º–∏ –¥–ª—è –Ω–∞–≥–ª—è–¥–Ω–æ—Å—Ç–∏

# –û–∂–∏–¥–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –≤—Å–µ—Ö –ø–æ—Ç–æ–∫–æ–≤
for t in threads:
    t.join()

print("\nüéâ –í—Å–µ —Ä–∞–±–æ—Ç—ã –∑–∞–≤–µ—Ä—à–µ–Ω—ã!")
```

## –ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞ (—É–ø—Ä–æ—â–µ–Ω–Ω—ã–π):

```
üöÄ –ó–∞–ø—É—Å–∫–∞–µ–º 10 —Ä–∞–±–æ—Ç–Ω–∏–∫–æ–≤ —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ–º –≤ 3 –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –¥–æ—Å—Ç—É–ø–∞

[14:30:01] –†–∞–±–æ—Ç–Ω–∏–∫ 0 –∂–¥–µ—Ç –¥–æ—Å—Ç—É–ø–∞...
[14:30:01] üü¢ –†–∞–±–æ—Ç–Ω–∏–∫ 0 –ø–æ–ª—É—á–∏–ª –¥–æ—Å—Ç—É–ø! (–∞–∫—Ç–∏–≤–Ω—ã–µ: [0])
[14:30:01] –†–∞–±–æ—Ç–Ω–∏–∫ 1 –∂–¥–µ—Ç –¥–æ—Å—Ç—É–ø–∞...
[14:30:01] üü¢ –†–∞–±–æ—Ç–Ω–∏–∫ 1 –ø–æ–ª—É—á–∏–ª –¥–æ—Å—Ç—É–ø! (–∞–∫—Ç–∏–≤–Ω—ã–µ: [0, 1])
[14:30:01] –†–∞–±–æ—Ç–Ω–∏–∫ 2 –∂–¥–µ—Ç –¥–æ—Å—Ç—É–ø–∞...
[14:30:01] üü¢ –†–∞–±–æ—Ç–Ω–∏–∫ 2 –ø–æ–ª—É—á–∏–ª –¥–æ—Å—Ç—É–ø! (–∞–∫—Ç–∏–≤–Ω—ã–µ: [0, 1, 2])
[14:30:01] –†–∞–±–æ—Ç–Ω–∏–∫ 3 –∂–¥–µ—Ç –¥–æ—Å—Ç—É–ø–∞...
[14:30:01] –†–∞–±–æ—Ç–Ω–∏–∫ 4 –∂–¥–µ—Ç –¥–æ—Å—Ç—É–ø–∞...
[14:30:01] –†–∞–±–æ—Ç–Ω–∏–∫ 5 –∂–¥–µ—Ç –¥–æ—Å—Ç—É–ø–∞...
[14:30:02] ‚úÖ –†–∞–±–æ—Ç–Ω–∏–∫ 1 –∑–∞–≤–µ—Ä—à–∏–ª —Ä–∞–±–æ—Ç—É (—Ä–∞–±–æ—Ç–∞–ª 1.2 —Å–µ–∫)
[14:30:02] üî¥ –†–∞–±–æ—Ç–Ω–∏–∫ 1 –æ—Å–≤–æ–±–æ–¥–∏–ª –¥–æ—Å—Ç—É–ø. (–æ—Å—Ç–∞–ª–∏—Å—å: [0, 2])
[14:30:02] üü¢ –†–∞–±–æ—Ç–Ω–∏–∫ 3 –ø–æ–ª—É—á–∏–ª –¥–æ—Å—Ç—É–ø! (–∞–∫—Ç–∏–≤–Ω—ã–µ: [0, 2, 3])
[14:30:03] ‚úÖ –†–∞–±–æ—Ç–Ω–∏–∫ 0 –∑–∞–≤–µ—Ä—à–∏–ª —Ä–∞–±–æ—Ç—É (—Ä–∞–±–æ—Ç–∞–ª 2.1 —Å–µ–∫)
[14:30:03] üî¥ –†–∞–±–æ—Ç–Ω–∏–∫ 0 –æ—Å–≤–æ–±–æ–¥–∏–ª –¥–æ—Å—Ç—É–ø. (–æ—Å—Ç–∞–ª–∏—Å—å: [2, 3])
[14:30:03] üü¢ –†–∞–±–æ—Ç–Ω–∏–∫ 4 –ø–æ–ª—É—á–∏–ª –¥–æ—Å—Ç—É–ø! (–∞–∫—Ç–∏–≤–Ω—ã–µ: [2, 3, 4])
...
```

## –ö–ª—é—á–µ–≤—ã–µ –º–æ–º–µ–Ω—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç —ç—Ç–æ—Ç –∫–æ–¥:

1. **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞**: –ù–µ –±–æ–ª–µ–µ 3 –ø–æ—Ç–æ–∫–æ–≤ —Ä–∞–±–æ—Ç–∞—é—Ç –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
2. **–û—á–µ—Ä–µ–¥—å –æ–∂–∏–¥–∞–Ω–∏—è**: –ü–æ—Ç–æ–∫–∏ 3-9 –∂–¥—É—Ç –≤ –æ—á–µ—Ä–µ–¥–∏, –ø–æ–∫–∞ –Ω–µ –æ—Å–≤–æ–±–æ–¥–∏—Ç—Å—è –º–µ—Å—Ç–æ
3. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–æ–±—É–∂–¥–µ–Ω–∏–µ**: –ö–æ–≥–¥–∞ –ø–æ—Ç–æ–∫ –æ—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç —Å–µ–º–∞—Ñ–æ—Ä, –æ–¥–∏–Ω –∏–∑ –æ–∂–∏–¥–∞—é—â–∏—Ö –ø–æ—Ç–æ–∫–æ–≤ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–ª—É—á–∞–µ—Ç –¥–æ—Å—Ç—É–ø
4. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `try-finally` –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ —Å–µ–º–∞—Ñ–æ—Ä –±—É–¥–µ—Ç –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω –¥–∞–∂–µ –ø—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –∏—Å–∫–ª—é—á–µ–Ω–∏—è
5. **–ß–µ—Å—Ç–Ω–æ—Å—Ç—å**: –û–±—ã—á–Ω–æ –ø–æ—Ç–æ–∫–∏ –ø–æ–ª—É—á–∞—é—Ç –¥–æ—Å—Ç—É–ø –≤ –ø–æ—Ä—è–¥–∫–µ –æ—á–µ—Ä–µ–¥–∏ (FIFO)

## –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤–Ω—É—Ç—Ä–∏ —Å–µ–º–∞—Ñ–æ—Ä–∞:

- **`.acquire()`**: –£–º–µ–Ω—å—à–∞–µ—Ç —Å—á–µ—Ç—á–∏–∫. –ï—Å–ª–∏ —Å—á–µ—Ç—á–∏–∫ > 0 - –ø–æ—Ç–æ–∫ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ä–∞–±–æ—Ç—É. –ï—Å–ª–∏ —Å—á–µ—Ç—á–∏–∫ = 0 - –ø–æ—Ç–æ–∫ –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è.
- **`.release()`**: –£–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç —Å—á–µ—Ç—á–∏–∫ –∏ —Ä–∞–∑–±–ª–æ–∫–∏—Ä—É–µ—Ç –æ–¥–∏–Ω –æ–∂–∏–¥–∞—é—â–∏–π –ø–æ—Ç–æ–∫.

–≠—Ç–æ—Ç –ø–∞—Ç—Ç–µ—Ä–Ω —á—Ä–µ–∑–≤—ã—á–∞–π–Ω–æ –ø–æ–ª–µ–∑–µ–Ω –¥–ª—è:
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
- –ö–æ–Ω—Ç—Ä–æ–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø–∞–º—è—Ç–∏/CPU
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è API –∑–∞–ø—Ä–æ—Å–æ–≤
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—É–ª–æ–º —Ä–µ—Å—É—Ä—Å–æ–≤




## –ë–∏–Ω–∞—Ä–Ω—ã–π —Å–µ–º–∞—Ñ–æ—Ä (Mutex)

```python
import threading

# –ë–∏–Ω–∞—Ä–Ω—ã–π —Å–µ–º–∞—Ñ–æ—Ä (–∑–Ω–∞—á–µ–Ω–∏–µ 1)
mutex = threading.Semaphore(1)

shared_counter = 0

def increment_counter(thread_id):
    global shared_counter
    
    for _ in range(5):
        # –ó–∞—Ö–≤–∞—Ç –º—å—é—Ç–µ–∫—Å–∞
        mutex.acquire()
        
        try:
            # –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è —Å–µ–∫—Ü–∏—è
            current = shared_counter
            print(f"–ü–æ—Ç–æ–∫ {thread_id}: —á–∏—Ç–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ {current}")
            time.sleep(0.1)  # –ò–º–∏—Ç–∞—Ü–∏—è —Ä–∞–±–æ—Ç—ã
            shared_counter = current + 1
            print(f"–ü–æ—Ç–æ–∫ {thread_id}: –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ {shared_counter}")
        finally:
            # –û—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ –º—å—é—Ç–µ–∫—Å–∞
            mutex.release()
        
        time.sleep(0.01)

# –ó–∞–ø—É—Å–∫ –ø–æ—Ç–æ–∫–æ–≤
threads = []
for i in range(3):
    t = threading.Thread(target=increment_counter, args=(i,))
    threads.append(t)
    t.start()

for t in threads:
    t.join()

print(f"–§–∏–Ω–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —Å—á–µ—Ç—á–∏–∫–∞: {shared_counter}")
```
–û—Ç–ª–∏—á–Ω—ã–π –ø—Ä–∏–º–µ—Ä! –î–∞–≤–∞–π—Ç–µ —Ä–∞–∑–±–µ—Ä–µ–º –µ–≥–æ —Ä–∞–±–æ—Ç—É –ø–æ–¥—Ä–æ–±–Ω–æ. –≠—Ç–æ—Ç –∫–æ–¥ –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç **–≤–∑–∞–∏–º–æ–∏—Å–∫–ª—é—á–µ–Ω–∏–µ (mutual exclusion)** —Å –ø–æ–º–æ—â—å—é –±–∏–Ω–∞—Ä–Ω–æ–≥–æ —Å–µ–º–∞—Ñ–æ—Ä–∞.

## –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤ –ø—Ä–æ–≥—Ä–∞–º–º–µ:

### –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è:
```python
mutex = threading.Semaphore(1)  # –ë–∏–Ω–∞—Ä–Ω—ã–π —Å–µ–º–∞—Ñ–æ—Ä (—Ç–æ–ª—å–∫–æ 0 –∏–ª–∏ 1)
shared_counter = 0  # –û–±—â–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è, –∫–æ—Ç–æ—Ä—É—é –∑–∞—â–∏—â–∞–µ–º
```

## –î–µ—Ç–∞–ª—å–Ω—ã–π —Ä–∞–∑–±–æ—Ä —Ä–∞–±–æ—Ç—ã:

### –ë–µ–∑ –º—å—é—Ç–µ–∫—Å–∞ (–ø—Ä–æ–±–ª–µ–º–∞):
```
–ü–æ—Ç–æ–∫ 1: —á–∏—Ç–∞–µ—Ç shared_counter = 0
–ü–æ—Ç–æ–∫ 2: —á–∏—Ç–∞–µ—Ç shared_counter = 0  # ‚Üê –û–ë–ê –≤–∏–¥—è—Ç 0!
–ü–æ—Ç–æ–∫ 1: –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç 0 + 1 = 1
–ü–æ—Ç–æ–∫ 2: –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç 0 + 1 = 1       # ‚Üê –î–û–õ–ñ–ù–û –ë–´–¢–¨ 2, –Ω–æ –ø–æ–ª—É—á–∏–ª–æ—Å—å 1!
```

### –° –º—å—é—Ç–µ–∫—Å–æ–º (—Ä–µ—à–µ–Ω–∏–µ):
```
–ü–æ—Ç–æ–∫ 1: –∑–∞—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç –º—å—é—Ç–µ–∫—Å
–ü–æ—Ç–æ–∫ 1: —á–∏—Ç–∞–µ—Ç 0 ‚Üí –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç 1
–ü–æ—Ç–æ–∫ 1: –æ—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç –º—å—é—Ç–µ–∫—Å
–ü–æ—Ç–æ–∫ 2: –∑–∞—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç –º—å—é—Ç–µ–∫—Å
–ü–æ—Ç–æ–∫ 2: —á–∏—Ç–∞–µ—Ç 1 ‚Üí –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç 2
–ü–æ—Ç–æ–∫ 2: –æ—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç –º—å—é—Ç–µ–∫—Å
```

## –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:

```python
import threading
import time

# –ë–∏–Ω–∞—Ä–Ω—ã–π —Å–µ–º–∞—Ñ–æ—Ä (–∑–Ω–∞—á–µ–Ω–∏–µ 1) - —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω –ø–æ—Ç–æ–∫ –º–æ–∂–µ—Ç –∑–∞—Ö–≤–∞—Ç–∏—Ç—å
mutex = threading.Semaphore(1)

shared_counter = 0

def increment_counter(thread_id):
    global shared_counter
    
    for i in range(5):
        print(f"[{time.strftime('%H:%M:%S')}] –ü–æ—Ç–æ–∫ {thread_id} –ø—ã—Ç–∞–µ—Ç—Å—è –∑–∞—Ö–≤–∞—Ç–∏—Ç—å –º—å—é—Ç–µ–∫—Å (–∏—Ç–µ—Ä–∞—Ü–∏—è {i+1})")
        
        # –ó–ê–•–í–ê–¢: –ï—Å–ª–∏ –º—å—é—Ç–µ–∫—Å –∑–∞–Ω—è—Ç - –ø–æ—Ç–æ–∫ –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è –∑–¥–µ—Å—å
        mutex.acquire()
        
        try:
            print(f"[{time.strftime('%H:%M:%S')}] üü¢ –ü–æ—Ç–æ–∫ {thread_id} –≤–æ—à–µ–ª –≤ –∫—Ä–∏—Ç–∏—á–µ—Å–∫—É—é —Å–µ–∫—Ü–∏—é")
            
            # –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –°–ï–ö–¶–ò–Ø - —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω –ø–æ—Ç–æ–∫ –º–æ–∂–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å —ç—Ç–æ—Ç –∫–æ–¥
            current = shared_counter
            print(f"   –ü–æ—Ç–æ–∫ {thread_id}: —á–∏—Ç–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ {current}")
            
            # –ò–º–∏—Ç–∞—Ü–∏—è —Ä–∞–±–æ—Ç—ã (—á—Ç–µ–Ω–∏–µ/–æ–±—Ä–∞–±–æ—Ç–∫–∞/–∑–∞–ø–∏—Å—å)
            time.sleep(0.1)
            
            shared_counter = current + 1
            print(f"   –ü–æ—Ç–æ–∫ {thread_id}: –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ {shared_counter}")
            
        finally:
            # –û–°–í–û–ë–û–ñ–î–ï–ù–ò–ï: –≤—Å–µ–≥–¥–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è, –¥–∞–∂–µ –µ—Å–ª–∏ –±—ã–ª–æ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ
            mutex.release()
            print(f"[{time.strftime('%H:%M:%S')}] üî¥ –ü–æ—Ç–æ–∫ {thread_id} –≤—ã—à–µ–ª –∏–∑ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–π —Å–µ–∫—Ü–∏–∏")
        
        # –ù–µ–±–æ–ª—å—à–∞—è –ø–∞—É–∑–∞ –º–µ–∂–¥—É –∏—Ç–µ—Ä–∞—Ü–∏—è–º–∏
        time.sleep(0.01)

print("üöÄ –ó–∞–ø—É—Å–∫–∞–µ–º 3 –ø–æ—Ç–æ–∫–∞, –∫–∞–∂–¥—ã–π —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç —Å—á–µ—Ç—á–∏–∫ 5 —Ä–∞–∑")
print("üìä –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: 3 –ø–æ—Ç–æ–∫–∞ √ó 5 –∏—Ç–µ—Ä–∞—Ü–∏–π = 15")
print("=" * 50)

# –ó–∞–ø—É—Å–∫ –ø–æ—Ç–æ–∫–æ–≤
threads = []
for i in range(3):
    t = threading.Thread(target=increment_counter, args=(i,))
    threads.append(t)
    t.start()

# –û–∂–∏–¥–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –≤—Å–µ—Ö –ø–æ—Ç–æ–∫–æ–≤
for t in threads:
    t.join()

print("=" * 50)
print(f"üéØ –§–∏–Ω–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —Å—á–µ—Ç—á–∏–∫–∞: {shared_counter}")
print(f"‚úÖ –û–∂–∏–¥–∞–ª–æ—Å—å: 15, –ü–æ–ª—É—á–∏–ª–æ—Å—å: {shared_counter} - {'–°–û–í–ü–ê–õ–û!' if shared_counter == 15 else '–û–®–ò–ë–ö–ê!'}")
```

## –ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞ –ø—Ä–æ–≥—Ä–∞–º–º—ã:

```
üöÄ –ó–∞–ø—É—Å–∫–∞–µ–º 3 –ø–æ—Ç–æ–∫–∞, –∫–∞–∂–¥—ã–π —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç —Å—á–µ—Ç—á–∏–∫ 5 —Ä–∞–∑
üìä –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: 3 –ø–æ—Ç–æ–∫–∞ √ó 5 –∏—Ç–µ—Ä–∞—Ü–∏–π = 15
==================================================
[14:35:01] –ü–æ—Ç–æ–∫ 0 –ø—ã—Ç–∞–µ—Ç—Å—è –∑–∞—Ö–≤–∞—Ç–∏—Ç—å –º—å—é—Ç–µ–∫—Å (–∏—Ç–µ—Ä–∞—Ü–∏—è 1)
[14:35:01] üü¢ –ü–æ—Ç–æ–∫ 0 –≤–æ—à–µ–ª –≤ –∫—Ä–∏—Ç–∏—á–µ—Å–∫—É—é —Å–µ–∫—Ü–∏—é
   –ü–æ—Ç–æ–∫ 0: —á–∏—Ç–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ 0
   –ü–æ—Ç–æ–∫ 0: –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ 1
[14:35:01] üî¥ –ü–æ—Ç–æ–∫ 0 –≤—ã—à–µ–ª –∏–∑ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–π —Å–µ–∫—Ü–∏–∏
[14:35:01] –ü–æ—Ç–æ–∫ 1 –ø—ã—Ç–∞–µ—Ç—Å—è –∑–∞—Ö–≤–∞—Ç–∏—Ç—å –º—å—é—Ç–µ–∫—Å (–∏—Ç–µ—Ä–∞—Ü–∏—è 1)
[14:35:01] üü¢ –ü–æ—Ç–æ–∫ 1 –≤–æ—à–µ–ª –≤ –∫—Ä–∏—Ç–∏—á–µ—Å–∫—É—é —Å–µ–∫—Ü–∏—é
   –ü–æ—Ç–æ–∫ 1: —á–∏—Ç–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ 1
   –ü–æ—Ç–æ–∫ 1: –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ 2
[14:35:01] üî¥ –ü–æ—Ç–æ–∫ 1 –≤—ã—à–µ–ª –∏–∑ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–π —Å–µ–∫—Ü–∏–∏
[14:35:01] –ü–æ—Ç–æ–∫ 2 –ø—ã—Ç–∞–µ—Ç—Å—è –∑–∞—Ö–≤–∞—Ç–∏—Ç—å –º—å—é—Ç–µ–∫—Å (–∏—Ç–µ—Ä–∞—Ü–∏—è 1)
[14:35:01] üü¢ –ü–æ—Ç–æ–∫ 2 –≤–æ—à–µ–ª –≤ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–π —Å–µ–∫—Ü–∏–∏
   –ü–æ—Ç–æ–∫ 2: —á–∏—Ç–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ 2
   –ü–æ—Ç–æ–∫ 2: –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ 3
[14:35:01] üî¥ –ü–æ—Ç–æ–∫ 2 –≤—ã—à–µ–ª –∏–∑ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–π —Å–µ–∫—Ü–∏–∏
[14:35:01] –ü–æ—Ç–æ–∫ 0 –ø—ã—Ç–∞–µ—Ç—Å—è –∑–∞—Ö–≤–∞—Ç–∏—Ç—å –º—å—é—Ç–µ–∫—Å (–∏—Ç–µ—Ä–∞—Ü–∏—è 2)
[14:35:01] üü¢ –ü–æ—Ç–æ–∫ 0 –≤–æ—à–µ–ª –≤ –∫—Ä–∏—Ç–∏—á–µ—Å–∫—É—é —Å–µ–∫—Ü–∏—é
   –ü–æ—Ç–æ–∫ 0: —á–∏—Ç–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ 3
   –ü–æ—Ç–æ–∫ 0: –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ 4
...
==================================================
üéØ –§–∏–Ω–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —Å—á–µ—Ç—á–∏–∫–∞: 15
‚úÖ –û–∂–∏–¥–∞–ª–æ—Å—å: 15, –ü–æ–ª—É—á–∏–ª–æ—Å—å: 15 - –°–û–í–ü–ê–õ–û!
```

## –ß—Ç–æ –±—ã–ª–æ –±—ã –ë–ï–ó –º—å—é—Ç–µ–∫—Å–∞:

```python
import threading
import time

shared_counter = 0

def increment_counter_broken(thread_id):
    global shared_counter
    
    for _ in range(5):
        # –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –°–ï–ö–¶–ò–Ø –ë–ï–ó –ó–ê–©–ò–¢–´
        current = shared_counter
        print(f"–ü–æ—Ç–æ–∫ {thread_id}: —á–∏—Ç–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ {current}")
        
        time.sleep(0.1)  # –í —ç—Ç–æ –≤—Ä–µ–º—è –¥—Ä—É–≥–∏–µ –ø–æ—Ç–æ–∫–∏ —Ç–æ–∂–µ –º–æ–≥—É—Ç —á–∏—Ç–∞—Ç—å —Å—Ç–∞—Ä–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
        
        shared_counter = current + 1
        print(f"–ü–æ—Ç–æ–∫ {thread_id}: –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ {shared_counter}")
        
        time.sleep(0.01)

print("üö® –ó–∞–ø—É—Å–∫ –ë–ï–ó –º—å—é—Ç–µ–∫—Å–∞ (–¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –≥–æ–Ω–∫–∏ –¥–∞–Ω–Ω—ã—Ö):")
threads = []
for i in range(3):
    t = threading.Thread(target=increment_counter_broken, args=(i,))
    threads.append(t)
    t.start()

for t in threads:
    t.join()

print(f"üí• –§–∏–Ω–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ: {shared_counter} (–¥–æ–ª–∂–Ω–æ –±—ã—Ç—å 15)")
```

**–í—ã–≤–æ–¥ –±–µ–∑ –º—å—é—Ç–µ–∫—Å–∞ (–ø—Ä–∏–º–µ—Ä):**
```
–ü–æ—Ç–æ–∫ 0: —á–∏—Ç–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ 0
–ü–æ—Ç–æ–∫ 1: —á–∏—Ç–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ 0  # ‚Üê –û–ë–ê –ø—Ä–æ—á–∏—Ç–∞–ª–∏ 0!
–ü–æ—Ç–æ–∫ 2: —á–∏—Ç–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ 0  # ‚Üê –¢–†–û–ï –ø—Ä–æ—á–∏—Ç–∞–ª–∏ 0!
–ü–æ—Ç–æ–∫ 0: –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ 1
–ü–æ—Ç–æ–∫ 1: –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ 1  # ‚Üê –î–æ–ª–∂–Ω–æ –±—ã—Ç—å 2!
–ü–æ—Ç–æ–∫ 2: –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ 1  # ‚Üê –î–æ–ª–∂–Ω–æ –±—ã—Ç—å 3!
...
üí• –§–∏–Ω–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ: 5 (–¥–æ–ª–∂–Ω–æ –±—ã—Ç—å 15)
```

## –ö–ª—é—á–µ–≤—ã–µ –º–æ–º–µ–Ω—Ç—ã:

### 1. **–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è —Å–µ–∫—Ü–∏—è**:
```python
# –≠—Ç–æ—Ç –∫–æ–¥ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –¢–û–õ–¨–ö–û –æ–¥–Ω–∏–º –ø–æ—Ç–æ–∫–æ–º –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ:
current = shared_counter
time.sleep(0.1)  # –ò–º–∏—Ç–∞—Ü–∏—è —Ä–∞–±–æ—Ç—ã
shared_counter = current + 1
```

### 2. **–ó–∞—Ö–≤–∞—Ç –∏ –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ**:
- `mutex.acquire()` - –±–ª–æ–∫–∏—Ä—É–µ—Ç, –µ—Å–ª–∏ –º—å—é—Ç–µ–∫—Å –∑–∞–Ω—è—Ç
- `mutex.release()` - –æ—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç –¥–ª—è —Å–ª–µ–¥—É—é—â–µ–≥–æ –ø–æ—Ç–æ–∫–∞

### 3. **try-finally –≥–∞—Ä–∞–Ω—Ç–∏—è**:
```python
mutex.acquire()
try:
    # –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è —Å–µ–∫—Ü–∏—è
finally:
    mutex.release()  # –í–°–ï–ì–î–ê –≤—ã–ø–æ–ª–Ω–∏—Ç—Å—è, –¥–∞–∂–µ –ø—Ä–∏ –æ—à–∏–±–∫–µ
```

### 4. **–ü–æ—Ä—è–¥–æ–∫ –ø–æ—Ç–æ–∫–æ–≤**:
–ü–æ—Ç–æ–∫–∏ –ø–æ–ª—É—á–∞—é—Ç –º—å—é—Ç–µ–∫—Å –ø—Ä–∏–º–µ—Ä–Ω–æ –≤ –ø–æ—Ä—è–¥–∫–µ –æ—á–µ—Ä–µ–¥–∏ (–Ω–µ —Å—Ç—Ä–æ–≥–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–æ, –Ω–æ –æ–±—ã—á–Ω–æ FIFO).

## –ü–æ—á–µ–º—É —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:

1. **–ê—Ç–æ–º–∞—Ä–Ω–æ—Å—Ç—å –æ–ø–µ—Ä–∞—Ü–∏–π**: –ß—Ç–µ–Ω–∏–µ-–∏–∑–º–µ–Ω–µ–Ω–∏–µ-–∑–∞–ø–∏—Å—å –∑–∞—â–∏—â–µ–Ω—ã –æ—Ç –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏–π
2. **–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è –º—å—é—Ç–µ–∫—Å–∞**:
   - `1` - —Å–≤–æ–±–æ–¥–µ–Ω
   - `0` - –∑–∞–Ω—è—Ç, –µ—Å—Ç—å –æ–∂–∏–¥–∞—é—â–∏–µ
3. **–ß–µ—Ä–µ–¥–æ–≤–∞–Ω–∏–µ –ø–æ—Ç–æ–∫–æ–≤**: –ü–æ—Ç–æ–∫–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –ø–æ –æ—á–µ—Ä–µ–¥–∏ –≤ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–π —Å–µ–∫—Ü–∏–∏

–≠—Ç–æ—Ç –ø–∞—Ç—Ç–µ—Ä–Ω —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω–æ –≤–∞–∂–µ–Ω –¥–ª—è –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ–≥–æ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è! üõ°Ô∏è

## –°–µ–º–∞—Ñ–æ—Ä—ã —Å —Ç–∞–π–º–∞—É—Ç–æ–º

```python
import threading
import time

semaphore = threading.Semaphore(2)

def worker_with_timeout(worker_id):
    print(f"–†–∞–±–æ—Ç–Ω–∏–∫ {worker_id} –ø—ã—Ç–∞–µ—Ç—Å—è –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø...")
    
    # –ü–æ–ø—ã—Ç–∫–∞ –∑–∞—Ö–≤–∞—Ç–∞ —Å–µ–º–∞—Ñ–æ—Ä–∞ —Å —Ç–∞–π–º–∞—É—Ç–æ–º 2 —Å–µ–∫—É–Ω–¥—ã
    acquired = semaphore.acquire(timeout=2)
    
    if acquired:
        try:
            print(f"–†–∞–±–æ—Ç–Ω–∏–∫ {worker_id} –ø–æ–ª—É—á–∏–ª –¥–æ—Å—Ç—É–ø!")
            time.sleep(3)  # –î–æ–ª–≥–∞—è —Ä–∞–±–æ—Ç–∞
            print(f"–†–∞–±–æ—Ç–Ω–∏–∫ {worker_id} –∑–∞–≤–µ—Ä—à–∏–ª —Ä–∞–±–æ—Ç—É.")
        finally:
            semaphore.release()
    else:
        print(f"–†–∞–±–æ—Ç–Ω–∏–∫ {worker_id} –Ω–µ –¥–æ–∂–¥–∞–ª—Å—è –¥–æ—Å—Ç—É–ø–∞ –∏ —É—à–µ–ª!")

# –ó–∞–ø—É—Å–∫ –ø–æ—Ç–æ–∫–æ–≤
threads = []
for i in range(5):
    t = threading.Thread(target=worker_with_timeout, args=(i,))
    threads.append(t)
    t.start()
    time.sleep(0.5)  # –ó–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É –∑–∞–ø—É—Å–∫–∞–º–∏

for t in threads:
    t.join()
```

## –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü—Ä–∏–º–µ—Ä 1: –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö

```python
import threading
import time
import random

class DatabaseConnectionPool:
    def __init__(self, max_connections=5):
        self.semaphore = threading.Semaphore(max_connections)
        self.active_connections = 0
        self.lock = threading.Lock()
    
    def get_connection(self, thread_id):
        print(f"–ü–æ—Ç–æ–∫ {thread_id} –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ...")
        
        self.semaphore.acquire()
        
        with self.lock:
            self.active_connections += 1
            print(f"–ü–æ—Ç–æ–∫ {thread_id} –ø–æ–ª—É—á–∏–ª –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ. –ê–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π: {self.active_connections}")
        
        # –ò–º–∏—Ç–∞—Ü–∏—è —Ä–∞–±–æ—Ç—ã —Å –ë–î
        time.sleep(random.uniform(1, 2))
        
        self.release_connection(thread_id)
    
    def release_connection(self, thread_id):
        with self.lock:
            self.active_connections -= 1
            print(f"–ü–æ—Ç–æ–∫ {thread_id} –æ—Å–≤–æ–±–æ–¥–∏–ª –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ. –ê–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π: {self.active_connections}")
        
        self.semaphore.release()

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
db_pool = DatabaseConnectionPool(3)

def database_user(thread_id):
    db_pool.get_connection(thread_id)

threads = []
for i in range(10):
    t = threading.Thread(target=database_user, args=(i,))
    threads.append(t)
    t.start()

for t in threads:
    t.join()
```

### –ü—Ä–∏–º–µ—Ä 2: –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Å–∫–æ—Ä–æ—Å—Ç–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ (Rate Limiting)

```python
import threading
import time

class RateLimiter:
    def __init__(self, requests_per_second):
        self.semaphore = threading.Semaphore(requests_per_second)
        self.timer = None
        self.requests_per_second = requests_per_second
    
    def make_request(self, request_id):
        # –ó–∞—Ö–≤–∞—Ç —Å–µ–º–∞—Ñ–æ—Ä–∞
        acquired = self.semaphore.acquire(blocking=False)
        
        if acquired:
            print(f"–ó–∞–ø—Ä–æ—Å {request_id}: –í–´–ü–û–õ–ù–ï–ù")
            # –û—Å–≤–æ–±–æ–∂–¥–∞–µ–º —Å–µ–º–∞—Ñ–æ—Ä —á–µ—Ä–µ–∑ 1 —Å–µ–∫—É–Ω–¥—É
            threading.Timer(1.0, self.semaphore.release).start()
        else:
            print(f"–ó–∞–ø—Ä–æ—Å {request_id}: –û–¢–ö–õ–û–ù–ï–ù (–ø—Ä–µ–≤—ã—à–µ–Ω –ª–∏–º–∏—Ç)")
        
        return acquired

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ: –º–∞–∫—Å–∏–º—É–º 3 –∑–∞–ø—Ä–æ—Å–∞ –≤ —Å–µ–∫—É–Ω–¥—É
limiter = RateLimiter(3)

def make_requests():
    for i in range(10):
        limiter.make_request(i)
        time.sleep(0.2)  # 5 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ —Å–µ–∫—É–Ω–¥—É

make_requests()
```

## –°–µ–º–∞—Ñ–æ—Ä—ã vs –ú—å—é—Ç–µ–∫—Å—ã

### –°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞:

| –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞ | –°–µ–º–∞—Ñ–æ—Ä | –ú—å—é—Ç–µ–∫—Å |
|----------------|---------|---------|
| **–ó–Ω–∞—á–µ–Ω–∏–µ** | –õ—é–±–æ–µ –Ω–µ–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–µ —á–∏—Å–ª–æ | 0 –∏–ª–∏ 1 |
| **–í–ª–∞–¥–µ–ª–µ—Ü** | –ù–µ—Ç –ø–æ–Ω—è—Ç–∏—è –≤–ª–∞–¥–µ–ª—å—Ü–∞ | –ï—Å—Ç—å –≤–ª–∞–¥–µ–ª–µ—Ü |
| **–û—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ** | –õ—é–±–æ–π –ø–æ—Ç–æ–∫ –º–æ–∂–µ—Ç –æ—Å–≤–æ–±–æ–¥–∏—Ç—å | –¢–æ–ª—å–∫–æ –≤–ª–∞–¥–µ–ª–µ—Ü –º–æ–∂–µ—Ç –æ—Å–≤–æ–±–æ–¥–∏—Ç—å |
| **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ** | –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞ –∫ —Ä–µ—Å—É—Ä—Å—É | –í–∑–∞–∏–º–æ–∏—Å–∫–ª—é—á–µ–Ω–∏–µ |
| **–ü—Ä–∏–º–µ—Ä** | –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π –∫ –ë–î | –ó–∞—â–∏—Ç–∞ –æ–±—â–µ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π |

## –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏

### –û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–π —Å–µ–º–∞—Ñ–æ—Ä (BoundedSemaphore)

```python
import threading

# –û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–π —Å–µ–º–∞—Ñ–æ—Ä - –Ω–µ –º–æ–∂–µ—Ç –ø—Ä–µ–≤—ã—Å–∏—Ç—å –Ω–∞—á–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
bounded_sem = threading.BoundedSemaphore(3)

def worker_bounded(worker_id):
    bounded_sem.acquire()
    try:
        print(f"–†–∞–±–æ—Ç–Ω–∏–∫ {worker_id} —Ä–∞–±–æ—Ç–∞–µ—Ç...")
        time.sleep(1)
    finally:
        bounded_sem.release()
        # –ï—Å–ª–∏ –≤—ã–∑–≤–∞—Ç—å release() –µ—â–µ —Ä–∞–∑ - –±—É–¥–µ—Ç ValueError

# –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
bounded_sem.acquire()
# ... —Ä–∞–±–æ—Ç–∞ ...
bounded_sem.release()

# –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û (–≤—ã–∑–æ–≤–µ—Ç ValueError):
# bounded_sem.release()  # –±–µ–∑ –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ–≥–æ acquire
```

### –°–µ–º–∞—Ñ–æ—Ä—ã –≤ –º–Ω–æ–≥–æ–ø—Ä–æ—Ü–µ—Å—Å–Ω–æ–º –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–∏

```python
import multiprocessing
import time

def process_worker(semaphore, process_id):
    """–†–∞–±–æ—á–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –ø—Ä–æ—Ü–µ—Å—Å–∞"""
    print(f"–ü—Ä–æ—Ü–µ—Å—Å {process_id} –∂–¥–µ—Ç...")
    
    with semaphore:  # –ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ acquire/release
        print(f"–ü—Ä–æ—Ü–µ—Å—Å {process_id} –Ω–∞—á–∞–ª —Ä–∞–±–æ—Ç—É")
        time.sleep(2)
        print(f"–ü—Ä–æ—Ü–µ—Å—Å {process_id} –∑–∞–≤–µ—Ä—à–∏–ª —Ä–∞–±–æ—Ç—É")

if __name__ == "__main__":
    # –°–µ–º–∞—Ñ–æ—Ä –¥–ª—è –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ (–º–∞–∫—Å–∏–º—É–º 2 –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ)
    semaphore = multiprocessing.Semaphore(2)
    
    processes = []
    for i in range(6):
        p = multiprocessing.Process(
            target=process_worker, 
            args=(semaphore, i)
        )
        processes.append(p)
        p.start()
    
    for p in processes:
        p.join()
```

## –†–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–Ω—ã–µ –æ—à–∏–±–∫–∏ –∏ –ª—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏

### 1. –í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ try-finally
```python
# –ü–†–ê–í–ò–õ–¨–ù–û:
semaphore.acquire()
try:
    # —Ä–∞–±–æ—Ç–∞ —Å –∑–∞—â–∏—â–µ–Ω–Ω—ã–º —Ä–µ—Å—É—Ä—Å–æ–º
    do_critical_work()
finally:
    semaphore.release()  # –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ

# –†–ò–°–ö–û–í–ê–ù–ù–û:
semaphore.acquire()
do_critical_work()
semaphore.release()  # –µ—Å–ª–∏ –ø—Ä–æ–∏–∑–æ–π–¥–µ—Ç –∏—Å–∫–ª—é—á–µ–Ω–∏–µ - —Å–µ–º–∞—Ñ–æ—Ä –Ω–µ –æ—Å–≤–æ–±–æ–¥–∏—Ç—Å—è
```

### 2. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä
```python
# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ–º–∞—Ñ–æ—Ä–æ–º
with semaphore:
    do_critical_work()
# –°–µ–º–∞—Ñ–æ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç—Å—è –ø—Ä–∏ –≤—ã—Ö–æ–¥–µ –∏–∑ –±–ª–æ–∫–∞
```

### 3. –ò–∑–±–µ–≥–∞–π—Ç–µ –≤–∑–∞–∏–º–Ω—ã—Ö –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫ (deadlock)
```python
# –û–ü–ê–°–ù–û - –≤–æ–∑–º–æ–∂–µ–Ω deadlock
sem1 = threading.Semaphore(1)
sem2 = threading.Semaphore(1)

def thread1():
    sem1.acquire()
    sem2.acquire()  # –º–æ–∂–µ—Ç –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å—Å—è –∑–¥–µ—Å—å
    # ...
    sem2.release()
    sem1.release()

def thread2():
    sem2.acquire()
    sem1.acquire()  # –º–æ–∂–µ—Ç –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å—Å—è –∑–¥–µ—Å—å
    # ...
    sem1.release()
    sem2.release()
```

## –†–µ–∞–ª—å–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### 1. –í–µ–±-—Å–∫—Ä–∞–ø–∏–Ω–≥ —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ–º –∑–∞–ø—Ä–æ—Å–æ–≤
```python
import threading
import requests
import time

class Scraper:
    def __init__(self, max_concurrent=3, delay=1):
        self.semaphore = threading.Semaphore(max_concurrent)
        self.delay = delay
    
    def scrape_url(self, url, scraper_id):
        self.semaphore.acquire()
        
        try:
            print(f"–°–∫—Ä–∞–ø–µ—Ä {scraper_id} –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç {url}")
            response = requests.get(url, timeout=10)
            time.sleep(self.delay)  # –£–≤–∞–∂–∞–µ–º —Å–µ—Ä–≤–µ—Ä
            print(f"–°–∫—Ä–∞–ø–µ—Ä {scraper_id} –∑–∞–≤–µ—Ä—à–∏–ª {url} - —Å—Ç–∞—Ç—É—Å: {response.status_code}")
            return response.text
        finally:
            self.semaphore.release()

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
scraper = Scraper(max_concurrent=2)
urls = ["https://httpbin.org/delay/1"] * 10

threads = []
for i, url in enumerate(urls):
    t = threading.Thread(target=scraper.scrape_url, args=(url, i))
    threads.append(t)
    t.start()

for t in threads:
    t.join()
```

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

**–°–µ–º–∞—Ñ–æ—Ä—ã** - —ç—Ç–æ –º–æ—â–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è:
- ‚úÖ –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ —Ä–µ—Å—É—Ä—Å–∞–º
- ‚úÖ –†–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –ø–∞—Ç—Ç–µ—Ä–Ω–∞ "–ø—É–ª —Ä–µ—Å—É—Ä—Å–æ–≤"
- ‚úÖ –ö–æ–Ω—Ç—Ä–æ–ª—è —Å–∫–æ—Ä–æ—Å—Ç–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π
- ‚úÖ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –ø–æ—Ç–æ–∫–æ–≤/–ø—Ä–æ—Ü–µ—Å—Å–æ–≤

**–ö–ª—é—á–µ–≤—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã:**
1. –°–µ–º–∞—Ñ–æ—Ä—ã —É–ø—Ä–∞–≤–ª—è—é—Ç –¥–æ—Å—Ç—É–ø–æ–º, –∞ –Ω–µ –≤–ª–∞–¥–µ–Ω–∏–µ–º
2. –í—Å–µ–≥–¥–∞ –æ—Å–≤–æ–±–æ–∂–¥–∞–π—Ç–µ —Å–µ–º–∞—Ñ–æ—Ä—ã –≤ –±–ª–æ–∫–µ `finally`
3. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–µ –º–µ–Ω–µ–¥–∂–µ—Ä—ã –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
4. –í—ã–±–∏—Ä–∞–π—Ç–µ –ø–æ–¥—Ö–æ–¥—è—â–∏–π —Ç–∏–ø —Å–µ–º–∞—Ñ–æ—Ä–∞ –¥–ª—è –∑–∞–¥–∞—á–∏

–°–µ–º–∞—Ñ–æ—Ä—ã —è–≤–ª—è—é—Ç—Å—è —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω—ã–º building block –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω—ã—Ö –∏ –º–Ω–æ–≥–æ–ø—Ä–æ—Ü–µ—Å—Å–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π!